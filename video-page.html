<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CinemaVault - Video</title>
    <meta name="description" content="Watch premium video content on CinemaVault">
    <link rel="stylesheet" href="fontawesome/css/all.min.css"> <!-- https://fontawesome.com/ -->
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro&display=swap" rel="stylesheet">
    <!-- https://fonts.google.com/ -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/alex-rodriguez-portfolio.css">
    <link rel="stylesheet" href="css/i18n.css">
    <link rel="stylesheet" href="css/dark-mode.css">
    <link rel="stylesheet" href="css/clean-layout.css">
</head>

<body class="video-page">
	<div class="tm-page-wrap mx-auto">
		<div class="position-relative">
			<div class="position-absolute tm-site-header">
				<div class="container-fluid position-relative">
					<div class="row">						
                        <div class="col-12">
                            <div class="tm-site-nav">
                                <nav class="navbar navbar-expand-lg justify-content-center" id="tm-main-nav">
                                    <button class="navbar-toggler tm-bg-black py-2 px-3 mr-0 ml-auto collapsed" type="button"
                                        data-toggle="collapse" data-target="#navbar-nav" aria-controls="navbar-nav"
                                        aria-expanded="false" aria-label="Toggle navigation">
                                        <span>
                                            <i class="fas fa-bars tm-menu-closed-icon"></i>
                                            <i class="fas fa-times tm-menu-opened-icon"></i>
                                        </span>
                                    </button>
                                    <div class="collapse navbar-collapse tm-nav justify-content-center" id="navbar-nav">
                                        <ul class="navbar-nav text-uppercase">
                                            <li class="nav-item active">
                                                <a class="nav-link tm-nav-link" href="index.html" data-i18n="navigation.videos">Portfolio <span class="sr-only">(current)</span></a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link tm-nav-link" href="about.html" data-i18n="navigation.about">About Me</a>
                                            </li>
                                            <li class="nav-item">
                                                <a class="nav-link tm-nav-link" href="contact.html" data-i18n="navigation.contact">Work With Me</a>
                                            </li>
                                            <li class="nav-item d-lg-none">
                                                <button class="nav-link tm-nav-link theme-toggle-mobile" id="theme-toggle-mobile" style="border: none; background: none; color: inherit; width: 100%; text-align: left;">
                                                    <i class="fas fa-moon mr-2"></i>
                                                    <span>Dark Mode</span>
                                                </button>
                                            </li>
                                        </ul>
                                        <div class="language-toggle ml-3">
                                            <a href="#" class="lang-btn" data-lang="en">EN</a>
                                            <a href="#" class="lang-btn" data-lang="es">ES</a>
                                        </div>
                                        <button class="theme-toggle" id="theme-toggle">
                                            <i class="fas fa-moon"></i>
                                            <span>Dark</span>
                                        </button>
                                    </div>
                                </nav>
                            </div>
                        </div>
					</div>
				</div>
			</div>

		</div>

		<!-- Page content -->
		<div class="container-fluid">
			<div id="content" class="mx-auto tm-content-container">
				<main>
					<!-- Add extra spacing to avoid header collision -->
					<div class="row video-page-spacing mb-5 pb-4">
						<div class="col-12">
							<!-- Professional Custom Video Player -->
							<div class="video-player-container">
								<div class="video-wrapper">
									<video id="main-video" width="100%" height="auto" class="tm-main-video">
									  <source src="video/wheat-field.mp4" type="video/mp4">
									Your browser does not support the video tag.
									</video>

									<!-- Custom Video Controls -->
									<div class="custom-video-controls" id="video-controls">
										<!-- Top Info Bar -->
										<div class="video-info-bar">
											<h3 class="video-title tm-video-title" data-i18n="videos.cinematic_landscapes.title">Mountain Escape</h3>
											<div class="video-meta">
												<span class="video-author">Alex Rodriguez</span>
												<span class="video-date">January 15, 2024</span>
											</div>
										</div>

										<!-- Center Play Button -->
										<div class="center-play-button" id="center-play">
											<button class="big-play-btn" id="big-play-btn">
												<i class="fas fa-play"></i>
											</button>
										</div>

										<!-- Bottom Controls Bar -->
										<div class="controls-bar">
											<!-- Progress Bar -->
											<div class="progress-container">
												<div class="progress-bar" id="progress-bar">
													<div class="progress-filled" id="progress-filled"></div>
													<div class="progress-handle" id="progress-handle"></div>
												</div>
											</div>

											<!-- Control Buttons Row -->
											<div class="controls-row">
												<div class="controls-left">
													<button class="control-btn" id="play-pause-btn">
														<i class="fas fa-play"></i>
													</button>
													<button class="control-btn" id="volume-btn">
														<i class="fas fa-volume-up"></i>
													</button>
													<div class="volume-slider" id="volume-slider">
														<div class="volume-bar">
															<div class="volume-filled" id="volume-filled"></div>
															<div class="volume-handle" id="volume-handle"></div>
														</div>
													</div>
													<div class="time-display">
														<span id="current-time">0:00</span>
														<span class="time-separator">/</span>
														<span id="total-duration">0:00</span>
													</div>
												</div>

												<div class="controls-right">
													<button class="control-btn" id="speed-btn" title="Playback Speed">
														<i class="fas fa-tachometer-alt"></i>
														<span class="speed-text">1x</span>
													</button>
													<button class="control-btn" id="pip-btn" title="Picture in Picture">
														<i class="fas fa-external-link-alt"></i>
													</button>
													<button class="control-btn" id="fullscreen-btn" title="Fullscreen">
														<i class="fas fa-expand"></i>
													</button>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="row mb-5 pb-5">
						<div class="col-xl-8 col-lg-7">
							<!-- Video description -->
							<div class="tm-video-description-box">
								<h2 class="mb-5 tm-video-title" data-i18n="video_page.video_title">Mountain Escape</h2>
								<p class="mb-4" data-i18n="video_page.video_description">A personal project capturing the serene beauty of my weekend hiking trip to the Rocky Mountains. Shot with my drone during golden hour, this piece represents my love for nature photography and cinematography. This is one of my favorite personal moments - the peaceful silence of the mountains at sunset.</p>
								<div class="video-details mt-4">
									<p class="mb-2"><strong data-i18n="video_page.location">Location:</strong> <span data-i18n="video_page.location_value">Rocky Mountains, Colorado</span></p>
									<p class="mb-2"><strong data-i18n="video_page.date">Date:</strong> <span data-i18n="video_page.date_value">October 2023</span></p>
									<p class="mb-2"><strong data-i18n="video_page.equipment">Equipment:</strong> <span data-i18n="video_page.equipment_value">DJI Mavic 3, Sony A7IV</span></p>
								</div>
							</div>
						</div>
						<div class="col-xl-4 col-lg-5">
							<!-- Share box -->
							<div class="tm-bg-gray tm-share-box">
								<h6 class="tm-share-box-title mb-3" data-i18n="video_page.share">Share this memory</h6>
								<div class="mb-3">
									<button class="btn btn-primary btn-sm tm-share-modal-btn" onclick="openShareModal()">
										<i class="fas fa-share-alt mr-1"></i>
										<span data-i18n="video_page.share_button">Share Video</span>
									</button>
								</div>
								<p class="mb-4"><span data-i18n="video_page.author">Created by</span>: <span class="tm-text-primary">Alex Rodriguez</span></p>
								<div class="mb-3">
									<small class="text-muted" data-i18n="video_page.views">Personal collection â€¢ Private video</small>
								</div>
								<div>
									<button id="download-btn" class="btn btn-outline-primary btn-sm tm-btn-animate tm-download-btn" onclick="downloadVideo()">
										<i id="download-icon" class="fas fa-download mr-1"></i>
										<span id="download-text" data-i18n="video_page.download">Save to Device</span>
									</button>
								</div>
							</div>
						</div>
					</div>
					<!-- Related Videos Section with Index-style format -->
					<div class="row">
						<div class="col-12">
							<h2 class="tm-page-title mb-4" data-i18n="video_page.related">More from my collection</h2>

							<!-- Categories filter for related videos -->
							<div class="tm-categories-container mb-5">
								<h3 class="tm-text-primary tm-categories-text" data-i18n="video_page.filter_by">Filter by:</h3>
								<div class="tm-category-list">
									<a href="#" class="tm-category-link active" data-filter="all" data-i18n="catalog.all">All Projects</a>
									<a href="#" class="tm-category-link" data-filter="featured" data-i18n="catalog.featured">Featured Work</a>
									<a href="#" class="tm-category-link" data-filter="nature" data-i18n="catalog.nature">Nature</a>
									<a href="#" class="tm-category-link" data-filter="drone" data-i18n="catalog.drone">Aerial Shots</a>
									<a href="#" class="tm-category-link" data-filter="lifestyle" data-i18n="catalog.lifestyle">Lifestyle</a>
									<a href="#" class="tm-category-link" data-filter="actions" data-i18n="catalog.actions">Action</a>
									<a href="#" class="tm-category-link" data-filter="technology" data-i18n="catalog.technology">Tech Projects</a>
								</div>
							</div>
						</div>
					</div>

					<!-- Video Gallery with same format as index -->
					<div class="row" id="related-videos-container">
						<!-- Related videos will be dynamically loaded here with full descriptions -->
					</div>

					<!-- Pagination for related videos -->
					<div id="related-pagination-container" class="mb-5">
						<!-- Pagination will be dynamically generated here -->
					</div>
					</div>
				</main>

				<footer class="row pt-5">
                    <div class="col-12">
                        <div class="text-center mb-3">
                            <a href="privacy-policy.html" class="text-muted mr-3">Privacy Policy</a>
                            <a href="terms-of-use.html" class="text-muted">Terms of Use</a>
                        </div>
                        <p class="text-right" data-i18n="footer.copyright">Â© 2024 Alex Rodriguez - Visual Storyteller | Based in Colorado</p>
                    </div>
                </footer>
			</div> <!-- .tm-content-container -->
		</div>
	</div>

	<script src="js/jquery-3.4.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/i18n.js"></script>
    <script src="js/dark-mode.js"></script>
    <script src="js/video-page.js"></script>

    <!-- Share Modal -->
    <div id="shareModal" class="share-modal">
        <div class="share-modal-overlay" onclick="closeShareModal()"></div>
        <div class="share-modal-content">
            <div class="share-modal-header">
                <h3 class="share-modal-title" data-i18n="share_modal.title">Share Video</h3>
                <button class="share-modal-close" onclick="closeShareModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <div class="share-modal-body">
                <!-- Video Preview -->
                <div class="share-video-preview">
                    <div class="share-video-thumbnail">
                        <img id="share-thumbnail" src="" alt="Video thumbnail">
                        <div class="share-play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>
                    <div class="share-video-info">
                        <h4 id="share-video-title" class="share-video-title">Video Title</h4>
                        <p id="share-video-description" class="share-video-description">Video description...</p>
                        <div class="share-video-meta">
                            <span class="share-author">Alex Rodriguez</span>
                            <span class="share-date" id="share-video-date">Date</span>
                        </div>
                    </div>
                </div>

                <!-- Share Options -->
                <div class="share-options">
                    <h5 class="share-section-title" data-i18n="share_modal.social_title">Share on Social Media</h5>
                    <div class="share-social-buttons">
                        <button class="share-social-btn facebook" onclick="shareOnFacebook()">
                            <i class="fab fa-facebook-f"></i>
                            <span>Facebook</span>
                        </button>
                        <button class="share-social-btn twitter" onclick="shareOnX()">
                            <i class="fab fa-x-twitter"></i>
                            <span>X</span>
                        </button>
                        <button class="share-social-btn whatsapp" onclick="shareOnWhatsApp()">
                            <i class="fab fa-whatsapp"></i>
                            <span>WhatsApp</span>
                        </button>
                        <button class="share-social-btn linkedin" onclick="shareOnLinkedIn()">
                            <i class="fab fa-linkedin-in"></i>
                            <span>LinkedIn</span>
                        </button>
                    </div>
                </div>

                <!-- Copy Link -->
                <div class="share-link-section">
                    <h5 class="share-section-title" data-i18n="share_modal.link_title">Copy Link</h5>
                    <div class="share-link-container">
                        <input type="text" id="share-link-input" class="share-link-input" readonly>
                        <button id="copy-link-btn" class="share-copy-btn" onclick="copyShareLink()">
                            <i class="fas fa-copy"></i>
                            <span data-i18n="share_modal.copy">Copy</span>
                        </button>
                    </div>
                </div>

                <!-- Embed Code -->
                <div class="share-embed-section">
                    <h5 class="share-section-title" data-i18n="share_modal.embed_title">Embed Video</h5>
                    <div class="share-embed-container">
                        <textarea id="share-embed-code" class="share-embed-textarea" readonly></textarea>
                        <button id="copy-embed-btn" class="share-copy-btn" onclick="copyEmbedCode()">
                            <i class="fas fa-code"></i>
                            <span data-i18n="share_modal.copy_embed">Copy Code</span>
                        </button>
                    </div>
                </div>

                <!-- QR Code -->
                <div class="share-qr-section">
                    <h5 class="share-section-title" data-i18n="share_modal.qr_title">QR Code</h5>
                    <div class="share-qr-container">
                        <div id="share-qr-code" class="share-qr-code"></div>
                        <p class="share-qr-text" data-i18n="share_modal.qr_description">Scan to view on mobile</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Share Modal Functions
        function openShareModal() {
            const modal = document.getElementById('shareModal');
            const video = window.videoPageLoader?.currentVideo;

            if (video) {
                // Update modal content with current video data
                updateShareModalContent(video);

                // Show modal
                modal.classList.add('show');
                document.body.style.overflow = 'hidden';

                // Generate QR code
                generateQRCode(window.location.href);
            }
        }

        function closeShareModal() {
            const modal = document.getElementById('shareModal');
            modal.classList.remove('show');
            document.body.style.overflow = '';
        }

        function updateShareModalContent(video) {
            // Update thumbnail
            const thumbnail = document.getElementById('share-thumbnail');
            thumbnail.src = video.thumbnail;

            // Update title
            const title = document.getElementById('share-video-title');
            title.textContent = getDisplayTitle(video);

            // Update description
            const description = document.getElementById('share-video-description');
            description.textContent = getDisplayDescription(video);

            // Update date
            const date = document.getElementById('share-video-date');
            date.textContent = formatShareDate(video.date);

            // Update share link
            const linkInput = document.getElementById('share-link-input');
            linkInput.value = window.location.href;

            // Update embed code
            const embedTextarea = document.getElementById('share-embed-code');
            embedTextarea.value = generateEmbedCode(video);
        }

        function getDisplayDescription(video) {
            const descriptions = {
                'videos.cinematic_landscapes.description': 'A personal project capturing the serene beauty of my weekend hiking trip to the Rocky Mountains.',
                'videos.urban_timelapse.description': 'My ongoing documentation of urban life in downtown Denver.',
                'videos.ocean_waves.description': 'Summer vacation footage from my trip to the Pacific Coast.',
                'videos.mountain_adventure.description': 'Behind-the-scenes of my mountain climbing expedition.',
                'videos.forest_wildlife.description': 'A year-long project documenting wildlife in my local forest preserve.',
                'videos.sunset_magic.description': 'My favorite sunset captures from various locations around the world.',
                'videos.tech_innovation.description': 'A behind-the-scenes look at my creative workflow and process.',
                'videos.cultural_heritage.description': 'Documenting my grandmother\'s stories and our family traditions.',
                'videos.extreme_sports.description': 'Action footage from my friends\' extreme sports adventures.',
                'videos.wedding_moments.description': 'Intimate wedding cinematography capturing precious moments.',
                'videos.startup_story.description': 'Following the entrepreneurial journey of a Boulder-based tech startup.',
                'videos.adventure_hiking.description': 'Epic hiking adventures through Colorado\'s most challenging trails.'
            };
            return descriptions[video.description] || 'Personal video from Alex Rodriguez\'s collection.';
        }

        function formatShareDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        function generateEmbedCode(video) {
            const videoUrl = window.location.href;
            const title = getDisplayTitle(video);
            return `<iframe width="560" height="315" src="${videoUrl}" title="${title}" frameborder="0" allowfullscreen></iframe>`;
        }

        // Share functions for social media
        function shareOnFacebook() {
            const url = encodeURIComponent(window.location.href);
            const video = window.videoPageLoader?.currentVideo;
            const title = video ? getDisplayTitle(video) : 'Amazing Video';
            const text = encodeURIComponent(`Check out "${title}" from Alex Rodriguez's personal video collection!`);
            window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`, '_blank', 'width=600,height=400');
            closeShareModal();
        }

        function shareOnX() {
            const url = encodeURIComponent(window.location.href);
            const video = window.videoPageLoader?.currentVideo;
            const title = video ? getDisplayTitle(video) : 'Amazing Video';
            const text = encodeURIComponent(`"${title}" by Alex Rodriguez - Visual Storyteller ðŸŽ¬`);
            window.open(`https://x.com/intent/tweet?url=${url}&text=${text}`, '_blank', 'width=600,height=400');
            closeShareModal();
        }

        function shareOnWhatsApp() {
            const url = encodeURIComponent(window.location.href);
            const video = window.videoPageLoader?.currentVideo;
            const title = video ? getDisplayTitle(video) : 'Amazing Video';
            const text = encodeURIComponent(`Check out "${title}" from Alex Rodriguez's personal collection: `);
            window.open(`https://wa.me/?text=${text}${url}`, '_blank');
            closeShareModal();
        }

        function shareOnLinkedIn() {
            const url = encodeURIComponent(window.location.href);
            const video = window.videoPageLoader?.currentVideo;
            const title = video ? getDisplayTitle(video) : 'Amazing Video';
            const summary = encodeURIComponent(`Professional video work by Alex Rodriguez`);
            window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${url}&title=${encodeURIComponent(title)}&summary=${summary}`, '_blank', 'width=600,height=400');
            closeShareModal();
        }

        function copyShareLink() {
            const linkInput = document.getElementById('share-link-input');
            const copyBtn = document.getElementById('copy-link-btn');

            linkInput.select();
            navigator.clipboard.writeText(linkInput.value).then(() => {
                // Update button state
                const icon = copyBtn.querySelector('i');
                const text = copyBtn.querySelector('span');

                icon.className = 'fas fa-check';
                text.textContent = 'Copied!';
                copyBtn.classList.add('success');

                setTimeout(() => {
                    icon.className = 'fas fa-copy';
                    text.textContent = 'Copy';
                    copyBtn.classList.remove('success');
                }, 2000);
            });
        }

        function copyEmbedCode() {
            const embedTextarea = document.getElementById('share-embed-code');
            const copyBtn = document.getElementById('copy-embed-btn');

            embedTextarea.select();
            navigator.clipboard.writeText(embedTextarea.value).then(() => {
                // Update button state
                const icon = copyBtn.querySelector('i');
                const text = copyBtn.querySelector('span');

                icon.className = 'fas fa-check';
                text.textContent = 'Copied!';
                copyBtn.classList.add('success');

                setTimeout(() => {
                    icon.className = 'fas fa-code';
                    text.textContent = 'Copy Code';
                    copyBtn.classList.remove('success');
                }, 2000);
            });
        }

        function generateQRCode(url) {
            // Simple QR code generation using a free service
            const qrContainer = document.getElementById('share-qr-code');
            const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(url)}`;
            qrContainer.innerHTML = `<img src="${qrUrl}" alt="QR Code" class="qr-image">`;
        }

        // Close modal on Escape key
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeShareModal();
            }
        });

        // Professional Custom Video Player
        document.addEventListener('DOMContentLoaded', function() {
            const video = document.getElementById('main-video');
            const controls = document.getElementById('video-controls');
            const centerPlay = document.getElementById('center-play');
            const bigPlayBtn = document.getElementById('big-play-btn');
            const playPauseBtn = document.getElementById('play-pause-btn');
            const volumeBtn = document.getElementById('volume-btn');
            const progressBar = document.getElementById('progress-bar');
            const progressFilled = document.getElementById('progress-filled');
            const progressHandle = document.getElementById('progress-handle');
            const volumeSlider = document.getElementById('volume-slider');
            const volumeFilled = document.getElementById('volume-filled');
            const volumeHandle = document.getElementById('volume-handle');
            const currentTimeSpan = document.getElementById('current-time');
            const totalDurationSpan = document.getElementById('total-duration');
            const speedBtn = document.getElementById('speed-btn');
            const pipBtn = document.getElementById('pip-btn');
            const fullscreenBtn = document.getElementById('fullscreen-btn');

            let currentSpeedIndex = 2; // Start at 1x
            const speeds = [0.5, 0.75, 1, 1.25, 1.5, 2];
            let isDragging = false;
            let hideControlsTimeout;

            // Initialize player
            video.volume = 1;
            updateVolumeDisplay();

            // Format time in MM:SS format
            function formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            // Update time display
            function updateTimeDisplay() {
                if (video.duration) {
                    currentTimeSpan.textContent = formatTime(video.currentTime);
                    totalDurationSpan.textContent = formatTime(video.duration);

                    // Update progress bar
                    const progress = (video.currentTime / video.duration) * 100;
                    progressFilled.style.width = progress + '%';
                    progressHandle.style.left = progress + '%';
                }
            }

            // Update volume display
            function updateVolumeDisplay() {
                const volumePercent = video.volume * 100;
                volumeFilled.style.width = volumePercent + '%';
                volumeHandle.style.left = volumePercent + '%';

                // Update volume icon
                const volumeIcon = volumeBtn.querySelector('i');
                if (video.volume === 0 || video.muted) {
                    volumeIcon.className = 'fas fa-volume-mute';
                } else if (video.volume < 0.5) {
                    volumeIcon.className = 'fas fa-volume-down';
                } else {
                    volumeIcon.className = 'fas fa-volume-up';
                }
            }

            // Show/hide controls
            function showControls() {
                controls.classList.add('show');
                clearTimeout(hideControlsTimeout);

                if (!video.paused) {
                    hideControlsTimeout = setTimeout(() => {
                        controls.classList.remove('show');
                    }, 3000);
                }
            }

            function hideControls() {
                if (!video.paused) {
                    controls.classList.remove('show');
                }
            }

            // Play/Pause functionality
            function togglePlayPause() {
                if (video.paused) {
                    video.play();
                } else {
                    video.pause();
                }
            }

            function updatePlayPauseButton() {
                const icon = playPauseBtn.querySelector('i');
                const bigIcon = bigPlayBtn.querySelector('i');

                if (video.paused) {
                    icon.className = 'fas fa-play';
                    bigIcon.className = 'fas fa-play';
                    centerPlay.style.display = 'block';
                    controls.classList.add('show');
                } else {
                    icon.className = 'fas fa-pause';
                    bigIcon.className = 'fas fa-pause';
                    centerPlay.style.display = 'none';
                    showControls();
                }
            }

            // Event Listeners

            // Play/Pause buttons
            bigPlayBtn.addEventListener('click', togglePlayPause);
            playPauseBtn.addEventListener('click', togglePlayPause);
            video.addEventListener('click', togglePlayPause);

            // Video events
            video.addEventListener('play', updatePlayPauseButton);
            video.addEventListener('pause', updatePlayPauseButton);
            video.addEventListener('loadedmetadata', updateTimeDisplay);
            video.addEventListener('timeupdate', updateTimeDisplay);

            // Volume control
            volumeBtn.addEventListener('click', function() {
                video.muted = !video.muted;
                if (video.muted) {
                    video.volume = 0;
                } else {
                    video.volume = 1;
                }
                updateVolumeDisplay();
            });

            // Volume slider - Click and Drag
            let isVolumeSliding = false;

            function updateVolumeFromMouse(e) {
                const rect = volumeSlider.getBoundingClientRect();
                const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
                video.volume = percent;
                video.muted = false;
                updateVolumeDisplay();
            }

            volumeSlider.addEventListener('mousedown', function(e) {
                isVolumeSliding = true;
                updateVolumeFromMouse(e);
                e.preventDefault();
            });

            document.addEventListener('mousemove', function(e) {
                if (isVolumeSliding) {
                    updateVolumeFromMouse(e);
                }
            });

            document.addEventListener('mouseup', function() {
                isVolumeSliding = false;
            });

            volumeSlider.addEventListener('click', function(e) {
                if (!isVolumeSliding) {
                    updateVolumeFromMouse(e);
                }
            });

            // Progress bar - Click and Drag
            let isProgressSliding = false;

            function updateProgressFromMouse(e) {
                const rect = progressBar.getBoundingClientRect();
                const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
                video.currentTime = percent * video.duration;
            }

            progressBar.addEventListener('mousedown', function(e) {
                isProgressSliding = true;
                updateProgressFromMouse(e);
                e.preventDefault();
            });

            document.addEventListener('mousemove', function(e) {
                if (isProgressSliding) {
                    updateProgressFromMouse(e);
                }
            });

            document.addEventListener('mouseup', function() {
                isProgressSliding = false;
            });

            progressBar.addEventListener('click', function(e) {
                if (!isProgressSliding) {
                    updateProgressFromMouse(e);
                }
            });

            // Speed control
            speedBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                currentSpeedIndex = (currentSpeedIndex + 1) % speeds.length;
                const newSpeed = speeds[currentSpeedIndex];
                video.playbackRate = newSpeed;
                speedBtn.querySelector('.speed-text').textContent = `${newSpeed}x`;

                // Visual feedback
                speedBtn.style.background = 'rgba(77, 171, 247, 0.8)';
                setTimeout(() => {
                    speedBtn.style.background = 'none';
                }, 300);
            });

            // Picture in Picture
            pipBtn.addEventListener('click', async function(e) {
                e.stopPropagation();
                try {
                    if (document.pictureInPictureElement) {
                        await document.exitPictureInPicture();
                    } else {
                        await video.requestPictureInPicture();
                    }
                } catch (error) {
                    console.log('Picture-in-Picture not supported');
                }
            });

            // Fullscreen
            fullscreenBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                if (document.fullscreenElement) {
                    document.exitFullscreen();
                } else {
                    video.requestFullscreen().catch(err => {
                        console.log('Fullscreen not supported');
                    });
                }
            });

            // Update fullscreen icon
            document.addEventListener('fullscreenchange', function() {
                const icon = fullscreenBtn.querySelector('i');
                if (document.fullscreenElement) {
                    icon.className = 'fas fa-compress';
                    fullscreenBtn.title = 'Exit Fullscreen';
                } else {
                    icon.className = 'fas fa-expand';
                    fullscreenBtn.title = 'Fullscreen';
                }
            });

            // Mouse movement for controls
            const videoWrapper = document.querySelector('.video-wrapper');

            videoWrapper.addEventListener('mousemove', showControls);
            videoWrapper.addEventListener('mouseleave', hideControls);

            // Keyboard controls
            document.addEventListener('keydown', function(e) {
                if (e.target.tagName.toLowerCase() === 'input' || e.target.tagName.toLowerCase() === 'textarea') {
                    return;
                }

                switch(e.code) {
                    case 'Space':
                        e.preventDefault();
                        togglePlayPause();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        video.currentTime = Math.max(0, video.currentTime - 10);
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        video.currentTime = Math.min(video.duration, video.currentTime + 10);
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        video.volume = Math.min(1, video.volume + 0.1);
                        updateVolumeDisplay();
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        video.volume = Math.max(0, video.volume - 0.1);
                        updateVolumeDisplay();
                        break;
                    case 'KeyM':
                        e.preventDefault();
                        video.muted = !video.muted;
                        updateVolumeDisplay();
                        break;
                    case 'KeyF':
                        e.preventDefault();
                        fullscreenBtn.click();
                        break;
                }
            });

            // Initialize
            updatePlayPauseButton();
            updateTimeDisplay();
        });

        function downloadVideo() {
            const downloadBtn = document.getElementById('download-btn');
            const downloadIcon = document.getElementById('download-icon');
            const downloadText = document.getElementById('download-text');

            // Set loading state
            setDownloadState('loading');

            // Get current video data from the video page loader
            if (window.videoPageLoader && window.videoPageLoader.currentVideo) {
                const video = window.videoPageLoader.currentVideo;
                const videoFile = video.videoFile;
                const videoTitle = getVideoTitle(video);

                if (videoFile) {
                    // Simulate checking if file exists (in real app, you'd check server)
                    setTimeout(() => {
                        try {
                            // Create download link
                            const link = document.createElement('a');
                            link.href = videoFile;
                            link.download = `${videoTitle}.mp4`;
                            link.style.display = 'none';

                            // Add to DOM, click, and remove
                            document.body.appendChild(link);
                            link.click();
                            document.body.removeChild(link);

                            // Set success state
                            setDownloadState('success');
                            showDownloadMessage('success', `"${getDisplayTitle(video)}" download started!`);

                            // Reset button after 2 seconds
                            setTimeout(() => setDownloadState('default'), 2000);

                        } catch (error) {
                            setDownloadState('error');
                            showDownloadMessage('error', 'Download failed. Please try again.');
                            setTimeout(() => setDownloadState('default'), 2000);
                        }
                    }, 1000); // Simulate processing time
                } else {
                    setDownloadState('error');
                    showDownloadMessage('error', 'Video file not available for download');
                    setTimeout(() => setDownloadState('default'), 2000);
                }
            } else {
                setDownloadState('error');
                showDownloadMessage('error', 'Unable to download video at this time');
                setTimeout(() => setDownloadState('default'), 2000);
            }
        }

        function setDownloadState(state) {
            const downloadBtn = document.getElementById('download-btn');
            const downloadIcon = document.getElementById('download-icon');
            const downloadText = document.getElementById('download-text');

            // Reset classes
            downloadBtn.classList.remove('loading', 'success', 'error');
            downloadBtn.disabled = false;

            switch(state) {
                case 'loading':
                    downloadBtn.classList.add('loading');
                    downloadBtn.disabled = true;
                    downloadIcon.className = 'fas fa-spinner fa-spin mr-2';
                    downloadText.textContent = 'Preparing...';
                    break;

                case 'success':
                    downloadBtn.classList.add('success');
                    downloadIcon.className = 'fas fa-check mr-2';
                    downloadText.textContent = 'Downloaded!';
                    break;

                case 'error':
                    downloadBtn.classList.add('error');
                    downloadIcon.className = 'fas fa-exclamation-triangle mr-2';
                    downloadText.textContent = 'Try Again';
                    break;

                default:
                    downloadIcon.className = 'fas fa-download mr-2';
                    downloadText.textContent = 'Save to Device';
                    // Re-apply translation
                    if (window.i18n && window.i18n.translatePage) {
                        downloadText.setAttribute('data-i18n', 'video_page.download');
                        window.i18n.translatePage();
                    }
                    break;
            }
        }

        function getVideoTitle(video) {
            // Get filename-safe title
            const fallbacks = {
                'videos.cinematic_landscapes.title': 'Mountain_Escape',
                'videos.urban_timelapse.title': 'City_Life_Chronicles',
                'videos.ocean_waves.title': 'Coastal_Memories',
                'videos.mountain_adventure.title': 'Alpine_Adventure',
                'videos.forest_wildlife.title': 'Backyard_Wildlife',
                'videos.sunset_magic.title': 'Golden_Hour_Collection',
                'videos.tech_innovation.title': 'Creative_Process',
                'videos.cultural_heritage.title': 'Family_Heritage',
                'videos.extreme_sports.title': 'Weekend_Warriors',
                'videos.wedding_moments.title': 'Wedding_Memories',
                'videos.startup_story.title': 'Startup_Journey',
                'videos.adventure_hiking.title': 'Mountain_Adventures'
            };

            let title = fallbacks[video.title] || 'Personal_Video';
            // Clean filename (remove spaces, special chars)
            return title.replace(/[^a-zA-Z0-9_-]/g, '_');
        }

        function getDisplayTitle(video) {
            // Get display title for messages
            const displayTitles = {
                'videos.cinematic_landscapes.title': 'Mountain Escape',
                'videos.urban_timelapse.title': 'City Life Chronicles',
                'videos.ocean_waves.title': 'Coastal Memories',
                'videos.mountain_adventure.title': 'Alpine Adventure',
                'videos.forest_wildlife.title': 'Backyard Wildlife',
                'videos.sunset_magic.title': 'Golden Hour Collection',
                'videos.tech_innovation.title': 'Creative Process',
                'videos.cultural_heritage.title': 'Family Heritage',
                'videos.extreme_sports.title': 'Weekend Warriors',
                'videos.wedding_moments.title': 'Wedding Memories',
                'videos.startup_story.title': 'Startup Journey',
                'videos.adventure_hiking.title': 'Mountain Adventures'
            };

            return displayTitles[video.title] || 'Personal Video';
        }

        function showDownloadMessage(type, message) {
            // Create toast notification
            const toast = document.createElement('div');
            toast.className = `download-toast ${type}`;
            toast.innerHTML = `
                <div class="toast-content">
                    <i class="fas ${type === 'success' ? 'fa-check-circle' : 'fa-exclamation-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;

            // Add to page
            document.body.appendChild(toast);

            // Show with animation
            setTimeout(() => toast.classList.add('show'), 100);

            // Remove after 3 seconds
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => document.body.removeChild(toast), 300);
            }, 3000);
        }
    </script>
</body>
</html>